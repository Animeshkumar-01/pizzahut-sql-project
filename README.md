# PIZZA HUT Sales Analysis SQL PROJECT

## Project Overview

**PROJECT TITLE**: PIZZA HUT Sales Analysis
<br>
**Database**: `pizza_sales_db`

This project is a SQL-based sales analysis project built using a PizzaHut sales dataset.
The main objective of this project is to demonstrate core SQL concepts such as database
creation, data insertion, joins, aggregations, and analytical querying on a real-world
business dataset.

## OBJECTIVES

1. Set up a PizzaHut sales database using multiple related tables.
2. Load data into SQL tables using CSV files and SQL INSERT statements.
3. Perform data analysis using SQL queries to answer business questions.
4. Analyze revenue, order trends, pizza categories, and popular pizza sizes.
5. Strengthen understanding of joins, aggregate functions, and grouping operations.

## Data Analysis & Findings

 Q1. **Retrive the total number of order placed**: 
```sql
   SELECT 
    COUNT(order_id)
  FROM
    orders;
```

 Q2. **Calculate the total revenue generated from pizza sales**:
```sql
SELECT 
    SUM(quantity) AS total_pizza_sold
FROM
    order_details;
```

  Q3. **Calculate the total revenue generated from pizza sales using pizza price and quantity sold**: 
```sql
SELECT 
    ROUND(SUM(order_details.quantity * pizzas.price),
            2) AS total_revenue
FROM
    order_details
        JOIN
    pizzas ON pizzas.pizza_id = order_details.pizza_id;
```

 Q4. **Identify the most expensive pizza by displaying its name, size, and price**:
```sql
SELECT 
    pizza_types.name, pizzas.size, pizzas.price
FROM
    pizza_types
        JOIN
    pizzas ON pizza_types.pizza_type_id = pizzas.pizza_type_id
ORDER BY pizzas.price DESC
LIMIT 1;
```

 Q5. **Determine which pizza size is ordered the most by customers based on total quantity sold**:
```sql
SELECT 
    pizzas.size, SUM(order_details.quantity) AS total_quantity
FROM
    order_details
        JOIN
    pizzas ON order_details.pizza_id = pizzas.pizza_id
GROUP BY pizzas.size
ORDER BY total_quantity DESC
LIMIT 1;
```

 Q6. **Calculate the total number of pizzas sold for each pizza category such as Classic, Veggie, Supreme, etc**: 
```sql
SELECT 
    pizza_types.category,
    SUM(order_details.quantity) AS total_quantity
FROM
    order_details
        JOIN
    pizzas ON order_details.pizza_id = pizzas.pizza_id
        JOIN
    pizza_types ON pizzas.pizza_type_id = pizza_types.pizza_type_id
GROUP BY pizza_types.category;
```

 Q7. **Calculate the total revenue generated by each pizza category**:
```sql
SELECT 
    pizza_types.category,
    SUM(order_details.quantity * pizzas.price) AS total_revenue
FROM
    order_details
        JOIN
    pizzas ON order_details.pizza_id = pizzas.pizza_id
        JOIN
    pizza_types ON pizza_types.pizza_type_id = pizzas.pizza_type_id
GROUP BY pizza_types.category;
```

 Q8. **Identify the top five most ordered pizzas based on the total quantity sold**: 
```sql
SELECT 
    pizza_types.name,
    SUM(order_details.quantity) AS most_ordered
FROM
    order_details
        JOIN
    pizzas ON order_details.pizza_id = pizzas.pizza_id
        JOIN
    pizza_types ON pizzas.pizza_type_id = pizza_types.pizza_type_id
GROUP BY pizza_types.name
ORDER BY most_ordered DESC
LIMIT 5;
```

 Q9. **Analyze daily order trends by calculating the total number of orders placed on each date**:
```sql
SELECT 
    orders.order_date, COUNT(orders.order_id) AS total_orders
FROM
    orders
GROUP BY orders.order_date
ORDER BY orders.order_date;
```

 Q10. **Analyze customer ordering behavior by identifying the hour of the day with the highest number of orders**:
```sql
SELECT 
    HOUR(orders.order_time) AS total_hour,
    COUNT(orders.order_id) AS total_order
FROM
    orders
GROUP BY orders.order_time
ORDER BY total_order DESC
LIMIT 1;
```

 Q11.**Calculate the percentage contribution of each pizza type to total revenue**: 
```sql
SELECT 
    pizza_types.category,
    (SUM(order_details.quantity * price) / (SELECT 
            ROUND(SUM(order_details.quantity * pizzas.price),
                        2) AS total_sales
        FROM
            order_details
                JOIN
            pizzas ON pizzas.pizza_id = order_details.pizza_id) * 100 , 2) AS revenue
FROM
    pizza_types
        JOIN
    pizzas ON pizza_types.pizza_type_id = pizzas.pizza_type_id
        JOIN
    order_details ON order_details.pizza_id = pizzas.pizza_id
GROUP BY pizza_types.category
ORDER BY revenue DESC;
```

 Q12. **Analyze the cumulative revenue over the time**: 
```sql
SELECT order_date,
SUM(revenue) over(order by order_date) as cum_revenue
from
(SELECT orders.order_date, 
SUM(order_details.quantity * pizzas.price) AS revenue
FROM order_details join pizzas
on order_details.pizza_id = pizzas.pizza_id
JOIN 
orders on orders.order_id = order_details.order_id
GROUP by orders.order_date) as sales;
```

## Conclusion

This project provides a comprehensive introduction to SQL for data analysis, covering database setup, exploratory data analysis, and business-focused SQL queries. 
Through this project, key insights were derived by analyzing sales patterns, customer behavior, and product performance.
